@page "/portfolio"

<div class="container is-max-desktop">
    <PortfolioTitle />
    <PortfolioSummary />
    <div class="box mt-4 mb-2 py-0 is-transparent"
         style="border-color: #4b4b4b; border-radius: 5px; border-style: solid; border-width: 1px;">
        <div class="columns is-gapless is-mobile">
            <div class="column">
                <strong>Coin</strong>
            </div>
            <div class="column has-text-centered">
                <strong>Price&emsp;</strong>
            </div>
            <div class="column has-text-right">
                <strong>Holdings&nbsp;</strong>
            </div>
        </div>
    </div>
    <AuthorizeView>
        <NotAuthorized>
            &ensp;Log in to display coins from your watchlist here!
        </NotAuthorized>
        <Authorized>
            @*TODO*@
        </Authorized>
    </AuthorizeView>
</div>

@code{

    [CascadingParameter] private Task<AuthenticationState> authenticationStateTask { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await GetLiveData();
    }

    private async Task<AuthenticationState> GetLiveData()
    {
        var authState = await authenticationStateTask;
        if (authState.User.Identity != null)
        {
            var user = authState.User;

            if (user.Identity.IsAuthenticated)
            {
                Console.WriteLine($"User {user.Identity.Name} is authed");
                return authState;
            }
            else
            {
                Console.WriteLine("user not authed");
                return authState;
            }
        }
        else
        {
            Console.WriteLine("user not authed");
            return authState;
        }
    }

}